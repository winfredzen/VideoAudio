# 音视频基础



## 音频

**音频的本质**

+ 从麦克风采集，到扬声器播放
+ 在直播项目中，一般从麦克风采集，从编程接口里面得到pcm buffer，这块内存就是音频数据

> 参考：
>
> + [计算机音频基础-PCM简介](https://www.cnblogs.com/TianFang/p/7894630.html)
>
> 我们在音频处理的时候经常会接触到`PCM`数据：它是模拟音频信号经模数转换（A/D变换）直接形成的二进制序列，该文件没有附加的文件头和文件结束标志。
>
> 声音本身是模拟信号，而计算机只能识别数字信号，要在计算机中处理声音，就需要将声音数字化，这个过程叫经模数转换（A/D变换）。最常见的方式是透过脉冲编码调制`PCM(Pulse Code Modulation)` 。

**音频属性**

参考：[音频属性相关：声道、采样率、采样位数、样本格式、比特率](https://www.cnblogs.com/yongdaimi/p/10722355.html)

+ 采样频率 - 每秒对声音进行采集的次数

+ 采样位数

  > 我们知道声音有轻有响，影响声音[响度](https://baike.baidu.com/item/响度)的物理要素是[振幅](https://baike.baidu.com/item/振幅)，作为[数码录音](https://baike.baidu.com/item/数码录音)，必须也要能精确表示乐曲的轻响，所以一定要对波形的振幅有一个精确的描述

+ 声道

  + 单声道 - mono
  + 双声道 - stereo，最常见的类型，包含左声道以及右声道





## 视频

在现实世界中，如果每秒刷新超过24张图片，看起来就很连续，参考：[零基础入门：实时音视频技术基础知识全面盘点](http://www.52im.net/thread-3079-1-1.html)

![001](https://github.com/winfredzen/VideoAudio/blob/main/images/001.gif)

+ 帧 - 是视频的一个基本概念，表示一张画面，如上面的翻页动画书中的一页，就是一帧。一个视频就是由许许多多帧组成的

+ 帧率 - 即单位时间内帧的数量，单位为：帧/秒 或`fps`（`frames per second`）。如动画书中，一秒内包含多少张图片，图片越多，画面越顺滑，过渡越自然

+ 分辨率 

  > 参考：[科普：视频分辨率是什么？](https://www.reneelab.com.cn/m/2k-4k-video-resolution.html)
  >
  > 视频分辨率又可称为视频解析度、解像度，指的是视频图像在一个单位尺寸内的精密度。当我们把一个视频放大数倍时，就会发现许多小方点，这些点就是构成影像的单位——像素。
  >
  > 视频的分辨率与像素密不可分，比如一个视频的分辨率为`1280*720`,就代表了这个视频的水平方向有`1280`个像素，垂直方向有`720`个像素。
  >
  > ![002](https://github.com/winfredzen/VideoAudio/blob/main/images/002.jpg)

+ 码率 - 视频码率就是数据传输时单位时间传送的数据位数，一般我们用的单位是`kbps`即千位每秒。一般来说RAW格式的码率比较大，每一张图片可以进行压缩



**视频采集**

从摄像头，sensor，感光元件，拍摄现实世界画面，把它存储为数字格式文件，如

+ JPG
+ RAW
+ YUV - 方便进行编码

通过`H.264`算法进行压缩。在网络传输的时候，在保证清晰度、分辨率的情况下，尽量降低视频的数据量，就更适合视频传输



**视频容器**

包含音频，编码后的视频数据，视频的关键数据（分辨率、帧率、时间戳等等）

+ mp4
+ mkv
+ avi
+ wmv



**视频编码**

为什么需要视频编码？主要为了存储和传输。

通过压缩算法，进行视频编码

+ 硬件编码 - iOS、Android，它们都自带硬件编码芯片
+ 软件编码 - 软件编码效率比较低，满足低端的、普通的视频聊天用，如open264、x264库



**H.264压缩算法**

H.264视频压缩算法是目前市面上应用最广泛的视频压缩技术

H.264视频压缩方式，参考：

+ [H.264基本原理与编码流程](https://www.cnblogs.com/Lxk0825/p/9925041.html)

![003](https://github.com/winfredzen/VideoAudio/blob/main/images/003.png)





## 网络传输

大部分的应用，大都基于2个基础的网络通信协议，TCP/IP UDP

+ TCP/IP - 可靠，适合数据量比较小的应用，比如web应用
  + 优点 - 在没有网络故障的情况下，绝对可靠
  + 缺点 - 传统的RTMP直播，4秒以上的延迟
+ UDP - 不可靠。适合做大量数据的传输，比如说，音视频。用UDP的时候，不能直接使用，要做大量的工作，比如，一定程度上的可靠性、丢包重传、完整性、网络拥塞控制等
  + 优点 - 高效率
  + 缺点 - 不可靠





目前有2种基础的应用架构

+ 流媒体转发 
  + 优点 - 支持百万、千万级别的客户端同时观看
  + 缺点 - 资源、带宽消耗大

![004](https://github.com/winfredzen/VideoAudio/blob/main/images/004.png)



+ P2P 
  + 优点 - 节省服务器资源
  + 缺点 - 不能做百万级别的人同时观看，不能做回放

![005](https://github.com/winfredzen/VideoAudio/blob/main/images/005.png)

































